import "./Test" exposing ( equals )
import "./List" exposing ( emptyList, map, indexedMap, filter, foldl, filterMap, append, reverse, length, take, drop )
import "./Maybe" exposing ( Maybe, Just, Nothing )

exposing (testEmptyList, testMap, testFilter, testFoldl, testFilterMap, testAppend, testReverse, testLength, testTake, testDrop)

testEmptyList: boolean -> void
testEmptyList a? =
    equals 0 emptyList.length

testMap: boolean -> void
testMap a? =
    let
        increment: number -> number
        increment x =
            x + 1
    in
        map increment [
            1,
            2
        ]
            |> equals [
            2,
            3
        ]

testIndexedMap: boolean -> void
testIndexedMap a? =
    let
        increment: number -> number -> number
        increment x i =
            x + i
    in
        indexedMap increment [
            0,
            10,
            20
        ]
            |> equals [
            0,
            11,
            22
        ]

testFilter: boolean -> void
testFilter a? =
    let
        isLessThanThree: number -> boolean
        isLessThanThree x =
            x < 3
    in
        filter isLessThanThree [
            1,
            2,
            3,
            4
        ]
            |> equals [
            1,
            2
        ]

testFoldl: boolean -> void
testFoldl a? =
    let
        add: number -> number -> number
        add a b =
            a + b
    in
        foldl add 0 [
            1,
            2,
            3
        ]
            |> equals 6

testFilterMap: boolean -> void
testFilterMap a? =
    let
        isLessThanThree: number -> any
        isLessThanThree x =
            if x < 3 then
                Just { value: x }
            else
                Nothing
    in
        filterMap isLessThanThree [
            1,
            2,
            3,
            4
        ]
            |> equals [
            1,
            2
        ]

testAppend: boolean -> void
testAppend a? =
    append [
        1,
        2
    ] [
        3,
        4
    ]
        |> equals [
        1,
        2,
        3,
        4
    ]

testReverse: boolean -> void
testReverse a? =
    reverse [
        1,
        2
    ]
        |> equals [
        2,
        1
    ]

testLength: boolean -> void
testLength a? =
    [
        1,
        2,
        3
    ]
        |> length
        |> equals 3

testTake: boolean -> void
testTake a? =
    [ 1..5 ]
        |> take 2
        |> equals [ 1..2 ]

testDrop: boolean -> void
testDrop a? =
    [ 1..5 ]
        |> drop 2
        |> equals [ 3..5 ]
